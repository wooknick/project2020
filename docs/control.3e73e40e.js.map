{"version":3,"sources":["control.js"],"names":["init","document","getElementsByClassName","innerHTML","length","nowPlaySource","AudioContext","window","webkitAudioContext","context","playSound","file","savedBuffer","xhr","play","source","createBufferSource","buffer","connect","destination","start","XMLHttpRequest","open","getFileURL","responseType","onload","decodeAudioData","response","incomingBuffer","console","log","stop","setTimeout","send","ret","preIndex","elem","querySelector","flkty","Flickity","cellAlign","dragThreshold","pageDots","prevNextButtons","on","ready","change","index","pageUpdate","page"],"mappings":";AAAA,IAAIA,EAAO,WACTC,SAASC,uBAAuB,cAAc,GAAGC,UAC/CF,OAAAA,OAAAA,SAASC,uBAAuB,gBAAgBE,SAGpDJ,IAGA,IAEIK,EAFAC,EAAeC,OAAOD,cAAgBC,OAAOC,mBAC7CC,EAAU,IAAIH,EAGdI,EAAY,SAAAC,GACVC,IAAAA,EASAC,EAPAC,EAAO,WACLC,IAAAA,EAASN,EAAQO,qBACrBX,EAAgBU,EAChBA,EAAOE,OAASL,EAChBG,EAAOG,QAAQT,EAAQU,aACvBJ,EAAOK,MAAM,KAEXP,EAAM,IAAIQ,gBACVC,KAAK,MAAOC,EAAWZ,IAAO,GAClCE,EAAIW,aAAe,cACnBX,EAAIY,OAAS,WACXhB,EAAQiB,gBAAgBb,EAAIc,SAAU,SAASC,GAC7ChB,EAAcgB,EACdC,QAAQC,IAAIzB,GACNA,IACJwB,QAAQC,IAAIzB,GACZA,EAAc0B,QAEhBC,WAAWlB,EAAM,QAGrBD,EAAIoB,QAGFV,EAAa,SAAAZ,GACXuB,IAAAA,EAAM,GAaHA,MAZM,SAATvB,EACFuB,EAAM,oEACY,oBAATvB,EACTuB,EACE,+EACgB,eAATvB,EACTuB,EACE,qGACgB,gBAATvB,IACTuB,EACE,4EAEGA,GAILC,EAAW,EACXC,EAAOnC,SAASoC,cAAc,YAC9BC,EAAQ,IAAIC,SAASH,EAAM,CAE7BI,UAAW,OACXC,cAAe,GACfC,UAAU,EACVC,iBAAiB,EACjBC,GAAI,CACFC,MAAO,WACLhB,QAAQC,IAAI,UAEdgB,OAAQ,SAASC,GACfC,EAAWD,GACM,IAAbZ,GAA4B,IAAVY,EACpBrC,EAAU,eACY,IAAbyB,GAA4B,IAAVY,EAC3BrC,EAAU,mBACY,IAAbyB,GAA4B,IAAVY,EAC3BrC,EAAU,eACY,IAAbyB,GAA4B,IAAVY,GAC3BrC,EAAU,QAEZyB,EAAWY,MAKjBT,EAAMM,GAAG,cAAe,WACjBvC,GACHK,EAAU,UAId,IAAIsC,EAAa,SAAAC,GACfhD,SAASC,uBAAuB,cAAc,GAAGC,UAAe8C,GAAAA,OAAAA,EAAO,EACrEhD,OAAAA,OAAAA,SAASC,uBAAuB,gBAAgBE","file":"control.3e73e40e.js","sourceRoot":"../src/public","sourcesContent":["var init = () => {\n  document.getElementsByClassName(\"pages_text\")[0].innerHTML = `1 / ${\n    document.getElementsByClassName(\"content_cell\").length\n  }`;\n};\ninit();\n\n// Sound 설정 시작\nvar AudioContext = window.AudioContext || window.webkitAudioContext;\nvar context = new AudioContext();\nvar nowPlaySource;\n\nvar playSound = file => {\n  var savedBuffer;\n  var xhr;\n  var play = () => {\n    var source = context.createBufferSource();\n    nowPlaySource = source;\n    source.buffer = savedBuffer;\n    source.connect(context.destination);\n    source.start(0);\n  };\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"get\", getFileURL(file), true);\n  xhr.responseType = \"arraybuffer\";\n  xhr.onload = () => {\n    context.decodeAudioData(xhr.response, function(incomingBuffer) {\n      savedBuffer = incomingBuffer;\n      console.log(nowPlaySource);\n      if (!!nowPlaySource) {\n        console.log(nowPlaySource);\n        nowPlaySource.stop();\n      }\n      setTimeout(play, 200);\n    });\n  };\n  xhr.send();\n};\n\nvar getFileURL = file => {\n  var ret = \"\";\n  if (file === \"dawn\") {\n    ret = \"https://dl.dropboxusercontent.com/s/4gre7t0md3z7skd/dawn.mp3?dl=0\";\n  } else if (file === \"magical_journey\") {\n    ret =\n      \"https://dl.dropboxusercontent.com/s/n27d4jo5le70cxf/magical_journey.mp3?dl=0\";\n  } else if (file === \"first_snow\") {\n    ret =\n      \"https://dl.dropboxusercontent.com/s/8a6a0s739iacjjy/music_zapsplat_rabbits_first_snow_143.mp3?dl=0\";\n  } else if (file === \"star_gazing\") {\n    ret =\n      \"https://dl.dropboxusercontent.com/s/v04fwko5ggxdjb3/star_gazing.mp3?dl=0\";\n  }\n  return ret;\n};\n\n// 슬라이드 설정 시작\nvar preIndex = 0;\nvar elem = document.querySelector(\".content\");\nvar flkty = new Flickity(elem, {\n  // options\n  cellAlign: \"left\",\n  dragThreshold: 10,\n  pageDots: false,\n  prevNextButtons: false,\n  on: {\n    ready: function() {\n      console.log(\"start\");\n    },\n    change: function(index) {\n      pageUpdate(index);\n      if (preIndex === 2 && index === 3) {\n        playSound(\"star_gazing\");\n      } else if (preIndex === 5 && index === 6) {\n        playSound(\"magical_journey\");\n      } else if (preIndex === 6 && index === 5) {\n        playSound(\"star_gazing\");\n      } else if (preIndex === 3 && index === 2) {\n        playSound(\"dawn\");\n      }\n      preIndex = index;\n    }\n  }\n});\n\nflkty.on(\"staticClick\", () => {\n  if (!nowPlaySource) {\n    playSound(\"dawn\");\n  }\n});\n\nvar pageUpdate = page => {\n  document.getElementsByClassName(\"pages_text\")[0].innerHTML = `${page + 1} / ${\n    document.getElementsByClassName(\"content_cell\").length\n  }`;\n};\n"]}